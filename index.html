<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî¨ Simulador de Compresi√≥n de Resorte</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ESTILOS BASE Y GENERALES (MANTENIDOS) */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px; /* Ajuste para m√≥vil: padding reducido */
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 20px; /* Ajuste para m√≥vil: padding reducido */
            text-align: center;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        /* --- MODIFICACI√ìN CLAVE: LAYOUT ADAPTABLE --- */

        .main-content {
            /* Por defecto (m√≥vil), usa una sola columna apilada */
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        .sidebar {
            background: #f8f9fa;
            padding: 15px; /* Ajuste para m√≥vil: padding reducido */
            border-right: none; /* Eliminar borde derecho en m√≥vil */
            border-bottom: 2px solid #e9ecef; /* A√±adir borde inferior en m√≥vil */
            min-height: auto; /* IMPORTANTE: Eliminar min-height en m√≥vil */
            order: 1; /* Asegurar que la barra lateral aparezca primero en el flujo del documento */
        }

        .content-area {
            padding: 15px; /* Ajuste para m√≥vil: padding reducido */
            order: 2; /* Asegurar que el contenido vaya despu√©s en el flujo del documento */
        }

        /* Contenedor para ocultar/mostrar controles en m√≥vil */
        .sidebar-content {
            display: none; /* Oculto por defecto en m√≥vil */
        }

        .sidebar-content.active {
            display: block; /* Mostrar cuando est√° activo */
        }
        
        /* Bot√≥n de control para m√≥viles */
        .mobile-toggle-button {
            display: block;
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
        }
        
        /* Estilos de Pesta√±as y Contenido (MANTENIDOS) */
        .tabs {
            display: flex;
            flex-wrap: wrap; /* Permitir que las pesta√±as se envuelvan */
            margin-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
        }

        .tab {
            padding: 10px 15px; /* Ajuste para m√≥vil */
            font-size: 14px;
        }

        .tab.active {
            background: white;
            border-bottom: 3px solid #3498db;
            color: #3498db;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .metrics-row {
            display: grid;
            grid-template-columns: 1fr; /* Una columna en m√≥vil */
            gap: 10px; /* Ajuste de gap */
            margin-bottom: 20px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr; /* Una columna en m√≥vil */
            gap: 15px; /* Ajuste de gap */
            margin-bottom: 20px;
        }
        
        .chart-container {
            /* Altura fija reducida para m√≥vil */
            height: 250px; 
            padding: 15px; 
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
        }
        
        .spring-container {
            padding: 15px;
        }
        
        /* Estilos de Componentes (MANTENIDOS) */
        .control-group { margin-bottom: 30px; }
        .control-group h3 { color: #2c3e50; margin-bottom: 15px; font-size: 1.3em; border-bottom: 2px solid #3498db; padding-bottom: 5px; }
        .slider-container { margin-bottom: 20px; }
        .slider-label { display: flex; justify-content: space-between; margin-bottom: 8px; font-weight: 600; }
        .slider-value { color: #e74c3c; font-weight: bold; }
        input[type="range"] { width: 100%; height: 8px; border-radius: 4px; background: #ddd; outline: none; -webkit-appearance: none; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 20px; height: 20px; border-radius: 50%; background: #3498db; cursor: pointer; border: 2px solid white; box-shadow: 0 2px 6px rgba(0,0,0,0.2); }
        input[type="number"] { width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px; font-size: 14px; }
        .metric-card { background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3); }
        .metric-value { font-size: 2em; font-weight: bold; margin: 10px 0; }
        .metric-label { font-size: 0.9em; opacity: 0.9; }
        .theory-box { background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 20px; margin-top: 20px; }
        .formula { background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0; font-family: 'Courier New', monospace; text-align: center; border-left: 4px solid #3498db; font-size: 1.1em; }
        footer { text-align: center; padding: 20px; background: #2c3e50; color: white; margin-top: 30px; }
        .divider { height: 2px; background: linear-gradient(90deg, transparent, #3498db, transparent); margin: 20px 0; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: 600; color: #2c3e50; }
        .warning { background: #ffeaa7; border: 1px solid #fdcb6e; border-radius: 5px; padding: 10px; margin: 10px 0; font-size: 0.9em; color: #e17055; }
        .critical { background: #ff6b6b; border: 1px solid #ee5a52; border-radius: 5px; padding: 10px; margin: 10px 0; font-size: 0.9em; color: white; font-weight: bold; }
        .results-box { background: #e8f4fd; border: 2px solid #3498db; border-radius: 10px; padding: 20px; margin-bottom: 20px; }
        .results-grid { display: grid; grid-template-columns: 1fr; gap: 10px; } /* Ajuste de grid a 1 columna en m√≥vil */


        /* MEDIA QUERY: Escritorio/Tableta (para restaurar la estructura de dos columnas) */
        @media (min-width: 768px) {
            body { padding: 20px; }
            
            .main-content {
                display: grid;
                grid-template-columns: 300px 1fr; /* Restaurar 2 columnas */
            }

            .sidebar {
                padding: 25px;
                border-right: 2px solid #e9ecef; /* Restaurar borde derecho */
                border-bottom: none;
                min-height: 100vh; /* Restaurar min-height */
                order: 1; 
            }
            
            .content-area {
                padding: 25px;
                order: 2;
            }

            .mobile-toggle-button {
                display: none; /* Ocultar el bot√≥n en escritorio */
            }

            .sidebar-content {
                display: block !important; /* Mostrar siempre el contenido en escritorio */
            }

            .metrics-row {
                grid-template-columns: repeat(3, 1fr); /* Restaurar 3 columnas */
                gap: 15px;
            }

            .charts-grid {
                grid-template-columns: 1fr 1fr; /* Restaurar 2 columnas */
                gap: 20px;
            }

            .chart-container {
                height: 300px; /* Restaurar altura */
            }
            
            .results-grid {
                grid-template-columns: 1fr 1fr; /* Restaurar 2 columnas */
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üî¨ Simulador de Compresi√≥n de Resorte</h1>
            <div class="subtitle">Ley de Hooke y C√°lculo Integral - F√≠sica Interactiva</div>
        </header>

        <div class="main-content">
            <div class="sidebar">
                <button class="mobile-toggle-button" id="toggleControlsButton" onclick="toggleSidebar()">
                    ‚öôÔ∏è Mostrar Controles
                </button>
                
                <div class="sidebar-content" id="sidebarContent">
                    <div class="control-group">
                        <h3>‚öôÔ∏è Configuraci√≥n</h3>
                        
                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Constante k</span>
                                <span class="slider-value" id="kValue">100 N/m</span>
                            </div>
                            <input type="range" id="kSlider" min="10" max="1000" value="100" step="10">
                            <div class="warning">
                                <strong>k = Rigidez:</strong> Mayor valor = resorte m√°s r√≠gido
                            </div>
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Longitud natural</span>
                                <span class="slider-value" id="lengthValue">1.0 m</span>
                            </div>
                            <input type="range" id="lengthSlider" min="0.5" max="5.0" value="1.0" step="0.1">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Compresi√≥n m√°xima</span>
                                <span class="slider-value" id="maxCompressionValue">2.0 m</span>
                            </div>
                            <input type="range" id="maxCompressionSlider" min="0.1" max="5.0" value="2.0" step="0.1">
                            <div class="warning">
                                <strong>Nota:</strong> Puedes ingresar compresiones mayores a la longitud natural para simular casos extremos
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <h3>üîç C√°lculo Espec√≠fico</h3>
                        
                        <div class="input-group">
                            <label>Compresi√≥n inicial (m)</label>
                            <input type="number" id="xInicial" min="0.0" max="10.0" value="0.0" step="0.1">
                        </div>
                        
                        <div class="input-group">
                            <label>Compresi√≥n final (m)</label>
                            <input type="number" id="xFinal" min="0.1" max="10.0" value="1.0" step="0.1">
                        </div>
                        
                        <button onclick="calcularTrabajoEspecifico()" style="width: 100%; padding: 12px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 14px;">
                            Calcular Trabajo
                        </button>
                    </div>

                    <div class="theory-box">
                        <h3>üìö Teor√≠a - Ley de Hooke</h3>
                        <div class="formula">
                            F = -k √ó x &nbsp;&nbsp;&nbsp; W = ¬Ω √ó k √ó x¬≤
                        </div>
                        <p><strong>F</strong>: Fuerza del resorte (N)<br>
                        <strong>k</strong>: Constante el√°stica (N/m)<br>
                        <strong>x</strong>: Compresi√≥n (m)<br>
                        <strong>W</strong>: Trabajo/Energ√≠a (J)</p>
                        <div class="warning">
                            <strong>‚ö†Ô∏è L√≠mite el√°stico:</strong> En la realidad, los resortes tienen un l√≠mite m√°ximo de compresi√≥n antes de deformarse permanentemente.
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-area">
                <div class="metrics-row">
                    <div class="metric-card">
                        <div class="metric-label">Constante k</div>
                        <div class="metric-value" id="metricK">100 N/m</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Longitud natural</div>
                        <div class="metric-value" id="metricLength">1.0 m</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Trabajo calculado</div>
                        <div class="metric-value" id="metricWork">0.00 J</div>
                    </div>
                </div>

                <div class="divider"></div>

                <div class="tabs">
                    <button class="tab active" onclick="openTab('tab1', this)">üìä Gr√°ficos Completos</button>
                    <button class="tab" onclick="openTab('tab2', this)">üéØ C√°lculo Espec√≠fico</button>
                    <button class="tab" onclick="openTab('tab3', this)">üîç Representaci√≥n F√≠sica</button>
                </div>

                <div id="tab1" class="tab-content active">
                    <h2>An√°lisis Gr√°fico Completo</h2>
                    
                    <div class="charts-grid">
                        <div class="chart-container">
                            <canvas id="workChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <canvas id="energyChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <canvas id="forceChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <canvas id="comparisonChart"></canvas>
                        </div>
                    </div>

                    <div class="theory-box">
                        <h3>üìù Explicaci√≥n de los gr√°ficos</h3>
                        <p><strong>Interpretaci√≥n f√≠sica:</strong><br>
                        - <strong>Trabajo</strong>: Energ√≠a que gastas para comprimir el resorte<br>
                        - <strong>Energ√≠a potencial</strong>: Energ√≠a que el resorte almacena<br>
                        - <strong>Fuerza</strong>: Esfuerzo necesario en cada punto<br><br>
                        <strong>¬°En un resorte ideal, el trabajo realizado es igual a la energ√≠a almacenada!</strong></p>
                    </div>
                </div>

                <div id="tab2" class="tab-content">
                    <h2>C√°lculo de Trabajo Espec√≠fico</h2>
                    
                    <div class="results-box">
                        <div class="results-grid">
                            <div>
                                <h3>üìã Par√°metros de Entrada</h3>
                                <p><strong>Compresi√≥n inicial:</strong> <span id="inputInicial">0.0</span> m</p>
                                <p><strong>Compresi√≥n final:</strong> <span id="inputFinal">1.0</span> m</p>
                                <p><strong>Constante k:</strong> <span id="inputK">100</span> N/m</p>
                            </div>
                            <div>
                                <h3>üìä Resultados</h3>
                                <p><strong>Trabajo realizado:</strong> <span id="resultWork">0.00</span> J</p>
                                <p><strong>Fuerza inicial:</strong> <span id="resultForceInicial">0.00</span> N</p>
                                <p><strong>Fuerza final:</strong> <span id="resultForceFinal">0.00</span> N</p>
                                <p><strong>Energ√≠a almacenada:</strong> <span id="resultEnergy">0.00</span> J</p>
                            </div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <canvas id="specificWorkChart"></canvas>
                    </div>
                </div>

                <div id="tab3" class="tab-content">
                    <h2>Representaci√≥n F√≠sica del Resorte</h2>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Compresi√≥n actual</span>
                            <span class="slider-value" id="currentCompressionValue">0.5 m</span>
                        </div>
                        <input type="range" id="currentCompressionSlider" min="0.0" max="2.0" value="0.5" step="0.01">
                    </div>

                    <div class="metrics-row">
                        <div class="metric-card">
                            <div class="metric-label">Trabajo realizado</div>
                            <div class="metric-value" id="currentWork">0.00 J</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Fuerza actual</div>
                            <div class="metric-value" id="currentForce">0.00 N</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Energ√≠a almacenada</div>
                            <div class="metric-value" id="currentEnergy">0.00 J</div>
                        </div>
                    </div>

                    <div class="spring-container">
                        <canvas id="springCanvas" width="500" height="150"></canvas> 
                    </div>

                    <div class="theory-box">
                        <h3>Estado actual del resorte</h3>
                        <p><strong>Compresi√≥n:</strong> <span id="stateCompression">0.50</span> m (<span id="statePercentage">50.0</span>% de la longitud natural)<br>
                        <strong>Longitud actual:</strong> <span id="stateLength">0.50</span> m<br>
                        <strong>Energ√≠a lista para liberar:</strong> <span id="stateEnergy">0.00</span> J</p>
                        <div class="warning" id="compressionWarning" style="display: none;">
                            <strong>‚ö†Ô∏è Compresi√≥n extrema:</strong> La compresi√≥n actual es mayor que la longitud natural del resorte. En la realidad, esto podr√≠a causar deformaci√≥n permanente.
                        </div>
                        <div class="critical" id="maxCompressionWarning" style="display: none;">
                            <strong>üö´ COMPRESI√ìN M√ÅXIMA ALCANZADA:</strong> El resorte est√° completamente comprimido. En la realidad, esto destruir√≠a el resorte.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>üî¨ Simulador de F√≠sica - Ley de Hooke y C√°lculo Integral ‚Ä¢ Creado con HTML5, CSS3 y JavaScript</p>
        </footer>
    </div>

    <script>
        // Variables globales (MANTENIDAS)
        let k = 100;
        let naturalLength = 1.0;
        let maxCompression = 2.0;
        let currentCompression = 0.5;
        let xInicial = 0.0;
        let xFinal = 1.0;

        // Charts (MANTENIDOS)
        let workChart, energyChart, forceChart, comparisonChart, specificWorkChart;

        // --- FUNCIONES A√ëADIDAS/MODIFICADAS PARA MOVILIDAD ---
        
        // Funci√≥n para alternar la visibilidad de la barra lateral en m√≥vil
        function toggleSidebar() {
            const sidebarContent = document.getElementById('sidebarContent');
            const toggleButton = document.getElementById('toggleControlsButton');
            
            sidebarContent.classList.toggle('active');

            if (sidebarContent.classList.contains('active')) {
                toggleButton.innerHTML = 'üîΩ Ocultar Controles';
            } else {
                toggleButton.innerHTML = '‚öôÔ∏è Mostrar Controles';
            }
        }
        
        // Funci√≥n de pesta√±as modificada para aceptar el elemento (para evitar depender de event.currentTarget)
        function openTab(tabName, element) {
            // Ocultar todos los contenidos de pesta√±as
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            
            // Desactivar todos los botones de pesta√±as
            const tabs = document.getElementsByClassName('tab');
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            // Mostrar la pesta√±a espec√≠fica
            document.getElementById(tabName).classList.add('active');
            element.classList.add('active');
            
            // Si es la pesta√±a 3 (Resorte), redibujar
            if (tabName === 'tab3') {
                dibujarResorte();
            }
        }

        // --- FUNCIONES DE C√ÅLCULO Y DIBUJO (MANTENIDAS Y LIGERAMENTE OPTIMIZADAS) ---
        
        function calcularFuerza(k, x) {
            return k * x; // F = k * x (valor absoluto)
        }

        function calcularTrabajo(k, x) {
            return 0.5 * k * x * x; // W = ¬Ω * k * x¬≤
        }

        function calcularEnergia(k, x) {
            return 0.5 * k * x * x; // U = ¬Ω * k * x¬≤
        }

        function calcularTrabajoEntrePuntos(k, xInicial, xFinal) {
            return calcularTrabajo(k, xFinal) - calcularTrabajo(k, xInicial);
        }

        function actualizarInterfaz() {
            // Actualizar valores mostrados
            document.getElementById('kValue').textContent = `${k} N/m`;
            document.getElementById('lengthValue').textContent = `${naturalLength} m`;
            document.getElementById('maxCompressionValue').textContent = `${maxCompression} m`;
            document.getElementById('currentCompressionValue').textContent = `${currentCompression.toFixed(2)} m`;
            
            // Asegurar que el slider de compresi√≥n actual no exceda el m√°ximo
            document.getElementById('currentCompressionSlider').max = maxCompression;
            
            document.getElementById('metricK').textContent = `${k} N/m`;
            document.getElementById('metricLength').textContent = `${naturalLength} m`;
            
            // Actualizar m√©tricas principales
            const trabajoEspecifico = calcularTrabajoEntrePuntos(k, xInicial, xFinal);
            document.getElementById('metricWork').textContent = `${trabajoEspecifico.toFixed(2)} J`;
            
            // Actualizar pesta√±a 3
            const trabajoActual = calcularTrabajo(k, currentCompression);
            const fuerzaActual = calcularFuerza(k, currentCompression);
            const energiaActual = calcularEnergia(k, currentCompression);
            
            document.getElementById('currentWork').textContent = `${trabajoActual.toFixed(2)} J`;
            document.getElementById('currentForce').textContent = `${fuerzaActual.toFixed(2)} N`;
            document.getElementById('currentEnergy').textContent = `${energiaActual.toFixed(2)} J`;
            
            document.getElementById('stateCompression').textContent = currentCompression.toFixed(2);
            const porcentaje = (currentCompression / naturalLength * 100).toFixed(1);
            document.getElementById('statePercentage').textContent = porcentaje;
            
            const longitudActual = Math.max(0, naturalLength - currentCompression);
            document.getElementById('stateLength').textContent = longitudActual.toFixed(2);
            document.getElementById('stateEnergy').textContent = energiaActual.toFixed(2);
            
            // Mostrar advertencias
            const warningElement = document.getElementById('compressionWarning');
            const maxWarningElement = document.getElementById('maxCompressionWarning');
            
            if (currentCompression >= naturalLength) {
                warningElement.style.display = 'block';
            } else {
                warningElement.style.display = 'none';
            }
            
            if (currentCompression >= maxCompression * 0.95) {
                maxWarningElement.style.display = 'block';
            } else {
                maxWarningElement.style.display = 'none';
            }
            
            // Redibujar gr√°ficos (siempre para asegurar que Chart.js tenga los datos actualizados)
            dibujarGraficos();
            // Solo redibujar el resorte si la pesta√±a est√° activa (optimizaci√≥n)
            if (document.getElementById('tab3').classList.contains('active')) {
                dibujarResorte();
            }
        }

        function dibujarResorte() {
            const canvas = document.getElementById('springCanvas');
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.clearRect(0, 0, width, height);
            
            // Calcular longitud actual con l√≠mites seguros
            const currentLength = Math.max(0.05, naturalLength - currentCompression); 
            
            // Escalar para visualizaci√≥n - Se ajusta la escala para el nuevo tama√±o de canvas
            const maxVisualLength = Math.max(naturalLength, maxCompression) + 0.5;
            const scaleX = (width - 80) / maxVisualLength; // Ajuste de factor de escala
            
            const startX = 40; // Ajuste de posici√≥n inicial
            const endX = startX + (currentLength * scaleX);
            const centerY = height / 2;
            
            // Punto fijo
            ctx.fillStyle = '#2c3e50';
            ctx.fillRect(startX - 15, centerY - 25, 15, 50); // Ajuste de tama√±o de muro
            
            // Resorte (forma de onda)
            if (currentLength > 0.05) {
                ctx.strokeStyle = currentCompression > naturalLength ? '#e74c3c' : '#3498db';
                ctx.lineWidth = 3; // Ajuste de grosor
                ctx.beginPath();
                
                const segments = Math.max(8, Math.min(20, Math.floor(currentLength * 15))); 
                const amplitude = 12 + (8 * (currentLength / naturalLength)); // Ajuste de amplitud
                
                for (let i = 0; i <= segments; i++) {
                    const t = i / segments;
                    const x = startX + t * (endX - startX);
                    const waveFactor = Math.sin(t * Math.PI * (segments / 2));
                    const y = centerY + amplitude * waveFactor * (1 - t * 0.3);
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                
                ctx.stroke();
            } else {
                // Resorte completamente comprimido
                ctx.strokeStyle = '#c0392b';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(startX, centerY - 10);
                ctx.lineTo(startX, centerY + 10);
                ctx.stroke();
            }
            
            // Punto m√≥vil
            const mobileX = Math.min(width - 25, Math.max(startX + 5, endX));
            ctx.fillStyle = currentCompression > naturalLength ? '#c0392b' : '#e74c3c';
            ctx.fillRect(mobileX, centerY - 20, 15, 40); // Ajuste de tama√±o de bloque
            
            // Etiquetas
            ctx.fillStyle = '#2c3e50';
            ctx.font = '12px Arial'; // Ajuste de fuente
            ctx.fillText('Fijo', startX - 5, centerY - 30);
            ctx.fillText('M√≥vil', mobileX, centerY - 30);
            ctx.fillText(`Compresi√≥n: ${currentCompression.toFixed(2)} m`, width / 2 - 60, 20);
            
            // Indicadores (ajuste de posici√≥n)
            if (currentCompression > naturalLength) {
                ctx.fillStyle = '#e74c3c';
                ctx.font = 'bold 14px Arial';
                ctx.fillText('‚ö° EXTREMA', width / 2 - 40, 40);
            }
            
            if (currentCompression >= maxCompression * 0.95) {
                ctx.fillStyle = '#c0392b';
                ctx.font = 'bold 14px Arial';
                ctx.fillText('üö´ M√ÅXIMA', width / 2 - 35, 60);
            }
        }

        // La funci√≥n de dibujarGraficos y el resto de JS se mantienen igual
        // ya que Chart.js es responsive y maneja los canvas por s√≠ mismo.
        
        function dibujarGraficos() {
            // ... (El c√≥digo de dibujarGraficos se mantiene igual, ya que Chart.js maneja la responsividad interna)
            const compresiones = [];
            const trabajos = [];
            const energias = [];
            const fuerzas = [];
            
            // Generar datos
            const numPuntos = maxCompression > 3 ? 100 : 50;
            for (let x = 0; x <= maxCompression; x += maxCompression / numPuntos) {
                compresiones.push(x);
                trabajos.push(calcularTrabajo(k, x));
                energias.push(calcularEnergia(k, x));
                fuerzas.push(calcularFuerza(k, x));
            }
            
            // Gr√°fico de Trabajo
            if (workChart) workChart.destroy();
            workChart = new Chart(document.getElementById('workChart'), {
                type: 'line',
                data: {
                    labels: compresiones.map(x => x.toFixed(1)),
                    datasets: [{
                        label: 'Trabajo realizado',
                        data: trabajos,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Trabajo para comprimir el resorte'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Compresi√≥n (m)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Trabajo (J)'
                            },
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Gr√°fico de Energ√≠a
            if (energyChart) energyChart.destroy();
            energyChart = new Chart(document.getElementById('energyChart'), {
                type: 'line',
                data: {
                    labels: compresiones.map(x => x.toFixed(1)),
                    datasets: [{
                        label: 'Energ√≠a potencial',
                        data: energias,
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        borderWidth: 3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Energ√≠a potencial almacenada'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Compresi√≥n (m)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Energ√≠a (J)'
                            },
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Gr√°fico de Fuerza
            if (forceChart) forceChart.destroy();
            forceChart = new Chart(document.getElementById('forceChart'), {
                type: 'line',
                data: {
                    labels: compresiones.map(x => x.toFixed(1)),
                    datasets: [{
                        label: 'Fuerza aplicada',
                        data: fuerzas,
                        borderColor: '#27ae60',
                        backgroundColor: 'rgba(39, 174, 96, 0.1)',
                        borderWidth: 3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Fuerza necesaria para comprimir'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Compresi√≥n (m)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Fuerza (N)'
                            },
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Gr√°fico de Comparaci√≥n (Trabajo vs Energ√≠a)
            if (comparisonChart) comparisonChart.destroy();
            comparisonChart = new Chart(document.getElementById('comparisonChart'), {
                type: 'line',
                data: {
                    labels: compresiones.map(x => x.toFixed(1)),
                    datasets: [{
                        label: 'Trabajo (W)',
                        data: trabajos,
                        borderColor: '#3498db',
                        borderWidth: 2,
                        pointRadius: 0
                    },
                    {
                        label: 'Energ√≠a Potencial (U)',
                        data: energias,
                        borderColor: '#e74c3c',
                        borderWidth: 2,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Comparaci√≥n Trabajo vs Energ√≠a (W vs U)'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Compresi√≥n (m)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Valor (J)'
                            },
                            beginAtZero: true
                        }
                    }
                }
            });
        }
        
        function calcularTrabajoEspecifico() {
            // ... (El c√≥digo de calcularTrabajoEspecifico se mantiene igual)
            const x1 = parseFloat(document.getElementById('xInicial').value);
            const x2 = parseFloat(document.getElementById('xFinal').value);
            const trabajo = calcularTrabajoEntrePuntos(k, x1, x2);
            const fuerza1 = calcularFuerza(k, x1);
            const fuerza2 = calcularFuerza(k, x2);
            const energia = calcularEnergia(k, x2) - calcularEnergia(k, x1);
            
            document.getElementById('inputInicial').textContent = x1.toFixed(2);
            document.getElementById('inputFinal').textContent = x2.toFixed(2);
            document.getElementById('inputK').textContent = k;
            
            document.getElementById('resultWork').textContent = trabajo.toFixed(2);
            document.getElementById('resultForceInicial').textContent = fuerza1.toFixed(2);
            document.getElementById('resultForceFinal').textContent = fuerza2.toFixed(2);
            document.getElementById('resultEnergy').textContent = energia.toFixed(2);

            // Dibujar el gr√°fico espec√≠fico
            dibujarGraficoEspecifico(x1, x2);
            
            // Activar la pesta√±a 2
            const tab2Button = document.querySelector('.tabs button:nth-child(2)');
            openTab('tab2', tab2Button);
        }

        function dibujarGraficoEspecifico(x1, x2) {
            // ... (El c√≥digo de dibujarGraficoEspecifico se mantiene igual)
            const compresiones = [];
            const fuerzas = [];
            
            const maxVal = Math.max(x1, x2) + 0.2;
            const numPuntos = 50;
            for (let x = 0; x <= maxVal; x += maxVal / numPuntos) {
                compresiones.push(x);
                fuerzas.push(calcularFuerza(k, x));
            }
            
            if (specificWorkChart) specificWorkChart.destroy();
            specificWorkChart = new Chart(document.getElementById('specificWorkChart'), {
                type: 'line',
                data: {
                    labels: compresiones.map(x => x.toFixed(1)),
                    datasets: [{
                        label: 'Fuerza (F = k*x)',
                        data: fuerzas,
                        borderColor: '#9b59b6',
                        backgroundColor: 'rgba(155, 89, 182, 0.1)',
                        borderWidth: 2,
                        fill: true
                    },
                    {
                        label: 'Rango de Trabajo',
                        data: fuerzas.map((f, i) => {
                            const x = compresiones[i];
                            return (x >= Math.min(x1, x2) && x <= Math.max(x1, x2)) ? f : null;
                        }),
                        backgroundColor: 'rgba(52, 152, 219, 0.5)',
                        borderColor: 'transparent',
                        pointRadius: 0,
                        fill: 'origin'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'C√°lculo de Trabajo (√Årea bajo la curva F-x)'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Compresi√≥n (m)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Fuerza (N)'
                            },
                            beginAtZero: true
                        }
                    }
                }
            });
        }


        // Inicializaci√≥n y Listeners (MANTENIDOS)
        function inicializar() {
            document.getElementById('kSlider').addEventListener('input', (e) => {
                k = parseFloat(e.target.value);
                actualizarInterfaz();
            });

            document.getElementById('lengthSlider').addEventListener('input', (e) => {
                naturalLength = parseFloat(e.target.value);
                actualizarInterfaz();
            });

            document.getElementById('maxCompressionSlider').addEventListener('input', (e) => {
                maxCompression = parseFloat(e.target.value);
                document.getElementById('currentCompressionSlider').max = maxCompression;
                if (currentCompression > maxCompression) {
                    currentCompression = maxCompression;
                    document.getElementById('currentCompressionSlider').value = maxCompression;
                }
                actualizarInterfaz();
            });

            document.getElementById('currentCompressionSlider').addEventListener('input', (e) => {
                currentCompression = parseFloat(e.target.value);
                actualizarInterfaz();
            });

            document.getElementById('xInicial').addEventListener('input', (e) => {
                xInicial = parseFloat(e.target.value);
                actualizarInterfaz();
            });

            document.getElementById('xFinal').addEventListener('input', (e) => {
                xFinal = parseFloat(e.target.value);
                actualizarInterfaz();
            });
            
            actualizarInterfaz();
        }

        window.onload = inicializar;

    </script>
</body>
</html>
